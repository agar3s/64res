!function(){function e(e){return c&m[e]}function t(){var n=0,i=0;e("37")?(n=-1,D.setDirection(1)):e("39")&&(n=1,D.setDirection(0)),e("38")?i=-1:e("40")&&(i=1),H.x+=n,H.y+=i,H.x<0&&(H.x=0),H.y<0&&(H.y=0),r.fillStyle=o.d,r.fillRect(0,0,64*a,64*a),I.draw(H.x,H.y,64,64),C++,D.animate(),C>100&&(C=0),D.draw(),ra(t)}var n=document;n.get=n.getElementById;for(var i=n.get("c"),r=i.getContext("2d"),a=4,o={M:"#0E3A19",N:"#32623D",O:"#6D9F6B",P:"#96BA39"},s=0,f=["ms","moz","webkit","o"],l=0;l<f.length&&!window.requestAnimationFrame;++l)requestAnimationFrame=window[f[l]+"RequestAnimationFrame"];requestAnimationFrame||(requestAnimationFrame=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-s)),i=setTimeout(function(){e(t+n)},n);return s=t+n,i}),ra=requestAnimationFrame;var c=0,m={37:1,38:2,39:4,40:8,65:16,83:32,68:64,32:128,13:256};n.addEventListener("keydown",function(e){var t=e.keyCode||e.which;m[t]&&(c|=m[t],e.preventDefault())}),n.addEventListener("keyup",function(e){var t=e.keyCode?e.keyCode:e.which;c&m[t]&&(c^=m[t],e.preventDefault())});var u="{%{&{'{({5{7{8{E{F{G{H{e{f{g{h{u{v!\"/012@ABCPQRS`abcpqrs~*~.~:~>~K~L~N~_~o",h="{I{J{U{V{W{X{Y",d="{j",p="{'{({){*{7{9{:{G{H{I{J{g{h{i{j!\"#$1234ABCDQRSTabcdqrst~+~.~;~>~K~N~[~^~k~n",g="{K{L{W{X{Y{Z{[",y="{l",v=["","~p~O~;~9~8~(o_O?{D{6{4{$~o~N~L~K~*C{H{8{5{(","~N~H~=~7~-~'nN>.{t{d{C{5{3{#~O~>~;~:~9~8~.~(scSRB2\"{h{G{7{4{'","~`~W~G~p~H","~g~P~O~8~(RB~`~_~7~'nN>","~i~X~M~H~<~9~,~)2\"{G{7{4{'~g~W~P~G~=~8~-~(.{t{C{5{3{#","~k~Z~J~=~:~-~*scSC3{h{H{8{5{(~i~X~M~H~<~9~,~)o_O?/{d{D{6{4{$","~l~\\~M~K~<~;~,~+/~k~Z~O~J~=~:~-~*3","~o~_~L~>~:~.~*~l~\\~M~<~;~,~+","{T{Y","{S{J","{Y{I","{I{Y","{Y{J{S{I","{I{T","{Y","{Y{j","{H","{Y{H","{Z{Y","{j{Z","{i{j","{j{i","~\\~k","~k~\\","~_~n","~n~_","{M"],w={cocoM:{kf:u,f:[1,0,2,0,3,0,4,0,5,0,6,0,7,0,8]},cocoN:{kf:h,f:[9,0,10,0,11,0,12,0,13,0,14,0,15,0,15]},cocoO:{kf:d,f:[16,0,15,0,17,0,18,0,19,0,20,0,21,0,22]},heroM:{kf:p,f:[23,0,24,0,25,0,26]},heroN:{kf:g,f:[27,0,27,0,27,0,27]},heroO:{kf:y,f:[0,0,0,0,0,0,0]}},x=16,A=15,k=function(e){for(var t=new Int16Array(x),n=0;n<e.length;n++)t[e[n]>>4]|=1<<A-(15&e[n]);return t},S=function(e){for(var t=0,n=e[t],i=[];n;){var r=86;"{"==n[0]&&(n=e[++t],r=0),"~"==n[0]&&(n=e[++t],r=172),i.push(n.charCodeAt()+r-33),n=e[++t]}return i},F=function(e){var t=this;t.x=0,t.y=0,t.color="#000",t.byteArray=new Int16Array(x),t.data=S(e),t.frames=[],t.iFrame=0,t.byteArray=k(t.data),t.pixelSize=0,t.direction=0,t.relx=0,t.rely=0,t.setPixelSize=function(e){t.pixelSize=e,t.height=t.width=16*t.pixelSize},t.addFrame=function(e){t.frames.push(k(e)),t.iFrame=t.frames.length-1},t.animate=function(){if(++t.iFrame>=t.frames.length&&(t.iFrame=0),"string"==typeof t.frames[t.iFrame])return t.setAnimation(t.frames[t.iFrame]);for(var e=[],n=0;x>n;n++){t.byteArray[n]=t.byteArray[n]^t.frames[t.iFrame][n];for(var i=0;x>i;i++)1<<A-i&t.byteArray[n]&&e.push(n*x+i)}t.data=e},t.draw=function(){r.fillStyle=o[this.color];for(var e=0;e<t.data.length;e++){var n=15&t.data[e];r.fillRect(t.x+(t.direction?n:15-n)*t.pixelSize,t.y+(t.data[e]>>4)*t.pixelSize,t.pixelSize,t.pixelSize)}},t.setAnimation=function(e){if(t.currentAnimation!=e&&w[e]){t.currentAnimation=e,t.frames=[];var n=w[e].f;for(t.byteArray=k(S(w[e].kf)),j=0;j<n.length;j++){var i=v[n[j]];if(-1==n[j])return t.iFrame=t.frames.length,t.frames.push("i");t.addFrame(S(i))}}},t.setPosition=function(e,n){t.x=e,t.y=n}},z=function(e){var t=this;t.sprites=[];for(var n=0;n<e.length;n++){var i=new F(e[n].key);i.color=e[n].layer,console.log(i.color,o[this.color]),i.layer=e[n].layer,t.sprites.push(i)}t.pixelSize=0,t.setPixelSize=function(e){t.pixelSize=e,t.sprites.map(function(t){t.setPixelSize(e)})},t.animate=function(){t.sprites.map(function(e){e.animate()})},t.draw=function(){t.sprites.map(function(e){e.draw()})},t.setPos=function(e,n){t.sprites.map(function(t){t.x=e,t.y=n})},t.move=function(e,n){t.sprites.map(function(t){t.x+=e,t.y+=n})},t.setAnimation=function(e){t.sprites.map(function(t){t.setAnimation(e+t.layer)})},t.setDirection=function(e){t.sprites.map(function(t){t.direction=e})}},M=(new XMLHttpRequest,function(e){console.log(e),drawing=new Image,drawing.src=e,console.log(drawing),this.map=[];var t=this;drawing.onload=function(){r.drawImage(drawing,0,0);var e=r.getImageData(0,0,drawing.width,drawing.height),n=e.data,i=-1;console.log(t);for(var a=0,o=n.length;o>a;a+=4)a%drawing.width==0&&(t.map.push([]),i++),t.map[i].push(Math.floor(n[a]/64));console.log(t.map[0].length,t.map.length)},this.draw=function(e,t,n,i){e=e+n>=this.map[0].length?this.map[0].length-1-n:e,t=t+i>=this.map.length?this.map.length-1-i:t,console.log(t);for(var s=0;i>s;s++)for(var f=0;n>f;f++){var l=this.map[s+t][f+e];3!=l&&(r.fillStyle=o["MNO"[l]],r.fillRect(f*a,s*a,a,a))}}}),D=new z([{key:u,layer:"M"},{key:h,layer:"N"},{key:d,layer:"O"}]);D.setAnimation("coco"),D.setPixelSize(a),D.setPos(0,0);var I=new M("assets/asdsad.png"),C=0,H={x:0,y:0};ra(t)}();